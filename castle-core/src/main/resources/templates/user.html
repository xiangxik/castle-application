<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<style th:replace="/fragments :: head('用户')"></style>
</head>
<body class="hold-transition skin-blue sidebar-mini fixed">
	<div class="wrapper">

		<div th:replace="/fragments :: content-header"></div>
		<div th:replace="/fragments :: content-sidebar"></div>

		<div class="content-wrapper">
			<section class="content-header">
				<h1>
					用户列表 <small>列出系统的用户</small>
				</h1>
				<ol class="breadcrumb">
					<li><a href="#"><i class="fa fa-dashboard"></i> 用户管理</a></li>
					<li class="active">用户列表</li>
				</ol>
			</section>

			<section class="content">

				<div class="mailbox-controls">
					<div class="btn-group btn-group-sm">
						<a class="btn btn-primary" href="#/page/admin/add"> <i class="fa fa-plus"></i> 添加
						</a>
						<button aria-expanded="false" aria-haspopup="true" data-toggle="dropdown" class="btn btn-primary dropdown-toggle"
							type="button">
							批量 <span class="fa fa-caret-down"></span>
						</button>
						<ul class="dropdown-menu">
							<li><a href="javascript:;" id="delete-button"> <i class="glyphicon glyphicon-remove"></i> 删除
							</a></li>
						</ul>
					</div>
					<div class="btn-group btn-group-sm">
						<button id="open-search-button" type="button" class="btn btn-primary">
							<i class="fa fa-search"></i>
						</button>
						<button type="button" class="btn btn-warning" id="refresh-button">
							<i class="fa fa-refresh"></i>
						</button>
					</div>
				</div>

				<div class="box box-success" id="search-panel">
					<form id="search-form" class="form-search form-inline">
						<div class="box-body">
							<div class="form-group">
								<label for="search-username" class="control-label">账号</label> <input class="form-control" id="search-username"
									placeholder="请输入账号" name="username" type="text">
							</div>
							<div class="form-group">
								<label for="search-name" class="control-label">姓名</label> <input class="form-control" id="search-name"
									placeholder="请输入姓名" name="name" type="text">
							</div>
							<button type="submit" class="btn btn-primary btn-sm" id="search-button">
								<i class="fa fa-search"></i> 搜索
							</button>
						</div>
					</form>
				</div>

				<div class="box box-primary">
					<div class="box-body no-padding">
						<table id="grid-main" class="table table-hover">
							<thead>
								<tr>
									<th data-column-id="id" data-type="string" data-identifier="true" data-visible="false">ID</th>
									<th data-column-id="username">账号</th>
									<th data-column-id="name">姓名</th>
									<th data-formatter="businessType" data-css-class="hidden-xs" data-header-css-class="hidden-xs">角色</th>
									<th data-formatter="commands" data-css-class="command-column" data-width="120px" data-sortable="false"
										data-align="center" data-header-align="center">操作</th>
								</tr>
							</thead>
						</table>
					</div>
				</div>

			</section>

		</div>

		<div th:replace="/fragments :: content-footer"></div>
	</div>

	<div th:replace="/fragments :: javascript"></div>
	<script type="text/javascript">
		$(function() {
			'use strict'

			var parseQueryString = function(arr_url) {
				var reg_para = /([^&=]+)=([\w\W]*?)(&|$|#)/g, ret = {};
				if (arr_url) {
					var str_para = arr_url, result;
					while ((result = reg_para.exec(str_para)) != null) {
						if (result[2]) {
							ret[result[1]] = decodeURIComponent(result[2]);
						}
					}
				}
				return ret;
			};

			var $table = $("#grid-main");
			$table
					.bootgrid({
						url : base + "/user/page",
						post : function() {
							var keyValues = $("#search-form").serialize();
							return parseQueryString(keyValues);
						},
						formatters : {
							"commands" : function(column, row) {
								var link_edit = "<a href=\""+base+"/user/edit/"+row.id+"\"><i class=\"md-icon material-icons\">&#xE254;</i></a>";
								var link_delete = "<a href=\"javascript:;\"><i class=\"md-icon material-icons\">&#xE872;</i></a>";
								return link_edit + link_delete;
							}
						}
					});
			$("#search-button").on("click", function() {
				$table.bootgrid("reload");
				return false;
			});
		});
	</script>
</body>
</html>